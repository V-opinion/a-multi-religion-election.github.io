"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[29491],{593312:function(e,t,r){r.d(t,{$y:function(){return o},B_:function(){return T},D6:function(){return f},E5:function(){return Z},Eo:function(){return P},G5:function(){return n},Iv:function(){return b},J8:function(){return A},MH:function(){return l},Ry:function(){return B},Sb:function(){return m},TD:function(){return R},Tb:function(){return $},W8:function(){return a},WB:function(){return y},X9:function(){return U},bp:function(){return I},dr:function(){return u},e2:function(){return j},eN:function(){return S},fG:function(){return c},hH:function(){return p},jH:function(){return d},kI:function(){return v},kq:function(){return h},mD:function(){return x},nt:function(){return k},qf:function(){return i},qk:function(){return g},vr:function(){return C},xP:function(){return D},yB:function(){return w},zO:function(){return s}});let n="text-editor",i="placeholder",o=`.${i}`,a='span[data-slate-placeholder="true"]',u=`.${n}`,s="caption-editor-container",c=`.${s}`,l="story-container",d=`.${l}`,p="smesrimktanalytics",m="ArcGIS StoryMaps Enterprise Edition",g="https://example.com",f=["image/png","image/jpeg","image/gif","image/bmp","image/svg+xml"],h=["video/mp4"],I=["audio/mp3","audio/mpeg","audio/wav","audio/x-wav"],v=["application/pdf"],w=["application/gpx+xml","gpx"],y=1e7,$=5e7,b=25e6,k="smitem1",x="56rem",D=60,U=140,S=125,C=+(16/9).toFixed(4),A="Story data overwrite rejected",Z=60,P="Cannot duplicate story due to custom check",j=1080,E="41.7rem",T=E,R=E,B=6e3},412649:function(e,t,r){r.d(t,{Z:function(){return StoryBuilderError}});var n=r(437261);let StoryBuilderError=class StoryBuilderError extends Error{constructor(e){super(),this.name="StoryBuilderError";let{type:t,itemType:r}=e;this.type=this.message=t,this.itemType=r;let{statusCode:i}=(0,n.P)(this.type);this.statusCode=i}}},437261:function(e,t,r){r.d(t,{P:function(){return getErrorType},v:function(){return getErrorConfig}});var n=r(552322),i=r(342670),o=r(300994),a=r(808747),u=r(202205);let getErrorType=e=>{let t;let r="unknown";switch(e){case"story-privileges-create":case"story-privileges-edit":case"story-privileges-preview":case"theme-public-account":case"briefing-public-account":case"story-inaccessible":case"unsupported-account":case"sign-in":case"blocked-org":r=e,t=403;break;case"item-not-supported-on-route":case"story-not-found":r=e,t=404;break;case"story-load":case"org-settings-load":r=e,t=500;break;default:r="unknown",t=500}return{errorType:r,statusCode:t}},getErrorConfig=(e,t)=>({"unsupported-account":{title:(0,n.jsx)(i.Z,{id:"page.error.unsupportedTitle"}),description:(0,n.jsx)(i.Z,{id:`page.error.${t}.unknownDescription`})},"sign-in":{description:(0,n.jsx)(i.Z,{id:"page.error.signInDescription"})},"story-inaccessible":{description:(0,n.jsx)(i.Z,{id:`page.error.${t}.inaccessibleDescription`})},"story-not-found":{description:(0,n.jsx)(i.Z,{id:`page.error.${t}.inaccessibleDescription`})},"story-privileges-create":{description:(0,n.jsx)(i.Z,{id:"page.error.items.privilegesCreateDescription"})},"story-privileges-edit":{description:(0,n.jsx)(i.Z,{id:`page.error.${t}.privilegesEditDescription`})},"story-privileges-preview":{description:(0,n.jsx)(i.Z,{id:`page.error.${t}.privilegesPreviewDescription`})},"item-not-supported-on-route":{description:(0,n.jsx)(i.Z,{id:`page.error.${t}.inaccessibleDescription`})},"story-load":{description:(0,n.jsx)(i.Z,{id:"page.error.item.loadDescription"})},"org-settings-load":{description:(0,n.jsx)(i.Z,{id:"page.error.orgSettings.loadDescription"})},"theme-public-account":{title:(0,n.jsx)(i.Z,{id:"page.error.unknownTitle"}),description:(0,n.jsx)(i.Z,{id:"publicAccount.disabled.link",values:{"product-doc":e=>(0,n.jsx)("a",{href:"https://storymaps.arcgis.com/redirect/pricing",children:e})}})},"briefing-public-account":{title:(0,n.jsx)(i.Z,{id:"page.error.unknownTitle"}),description:(0,n.jsx)(i.Z,{id:"publicAccount.disabled.link",values:{"product-doc":e=>(0,n.jsx)("a",{href:"https://storymaps.arcgis.com/redirect/pricing",children:e})}})},"blocked-org":{icon:(0,n.jsx)(a.Z,{path:o.Z,size:32,sizeMultiplier:3,fill:u.default.color.emeraldGreen}),description:(0,n.jsx)(i.Z,{id:"page.error.noAccess"}),link:{href:`https://${e}`,isExternal:!0,text:(0,n.jsx)(i.Z,{id:"page.error.arcgisHome"})}},"distributed-collab-no-draft":{description:(0,n.jsx)(i.Z,{id:`page.error.${t}.unknownDescription`})},unknown:{description:(0,n.jsx)(i.Z,{id:`page.error.${t}.unknownDescription`})}})},409496:function(e,t,r){r.d(t,{$:function(){return isAppOnSafePortal}});let isAppOnSafePortal=(e,t)=>{try{let r=[window.location.hostname,"arcgis.com"],n=r?[t].concat(r):[t];for(let t of n){let r=new URL(e).hostname;if(new RegExp(t).test(r))return!0}return!1}catch{throw Error("Only available in browser environments with new URL()")}}},968843:function(e,t,r){r.d(t,{g:function(){return getProfileImageUrl},n:function(){return getBestImageWidth}});var n=r(201437),i=r(36076);let getBestImageWidth=e=>{let{width:t,fileName:r,shouldIgnoreDPR:o}=e;if(/\.(svg|gif)$/i.test(r??""))return 0;let a=o?1:(0,n.D7)(),u=t*a,s=i.C;for(let e of s)if(u<=e)return e;return Math.round(u)},getProfileImageUrl=e=>{let{basePortalUrl:t,user:r,token:n,timestamp:i,imageWidth:o}=e,{username:a,thumbnail:u}=r;if(!t||!a||!u)return"";let s=`${t}/community/users/${a}/info/${u}`,c=[];if(n&&c.push(`token=${n}`),i&&c.push(`ts=${i}`),o){let e=getBestImageWidth({width:o,fileName:u});e&&c.push(`w=${e}`)}return c.length?`${s}?${c.join("&")}`:s}},36076:function(e){e.exports.C=[20,50,100,200,400,600,800,1200,1600,2e3,2400]},476250:function(e,t,r){r.d(t,{A7:function(){return isItemOwnerOrAdmin},Dn:function(){return fetchItemResource},E8:function(){return getAgolItemDataUrlFromAWSUrl},HX:function(){return isDocumentItem},LZ:function(){return setItemFavoriteStatus},NJ:function(){return maybeAddTokenToItemUrl},Sg:function(){return getItemThumbnailUrl},WQ:function(){return isItemFavorite},ZX:function(){return isCopiedItem},_$:function(){return isItemIndexable},fW:function(){return isItemViewerDuplicable},gJ:function(){return getUnversionedItemResourceName},mY:function(){return getItemGroupIds},pz:function(){return getItemPage},rj:function(){return getVersionedItemResourceName},vb:function(){return getAllItemResources}});var n=r(348206),i=r(69378),o=r(166236),a=r(779485),u=r(841787),s=r(969252),c=r(672995),l=r(500052);let setItemFavoriteStatus=async e=>{let{authManager:t,isFavorite:r,itemId:i,owner:o}=e,a=await t.getUser();if(r){let e=await (0,n.Ju)({id:i,groupId:a.favGroupId,authentication:t,owner:o});return e}let u=await (0,n.lF)({id:i,groupId:a.favGroupId,authentication:t,owner:o});return u},getVersionedItemResourceName=(e,t)=>"published"===t?`${o.wC}${e}`:`${o.AY}${e}`,getUnversionedItemResourceName=e=>{let t=RegExp(`^(${o.AY}|${o.wC})`);return e.replace(t,"")},isItemFavorite=async(e,t,r)=>{if(!t)return!1;let i=await t.getUser();if(!i.favGroupId)return!1;let{items:o,nextStart:a}=await (0,n.Ye)(i.favGroupId,{authentication:t,paging:{num:100,start:"number"==typeof r?r:1}}),u=o.findIndex(t=>t.id===e);return -1!==u||-1!==a&&isItemFavorite(e,t,a)},getAllItemResources=async e=>{let{total:t,num:r,resources:i}=await (0,n.C)(e.itemId,{authentication:e.authManager,portal:e.portal,params:{owner:e.username}});if(t>r){let i=await Promise.all(Array(Math.ceil(t/r)).fill(void 0).reduce((t,i,o)=>[...t,(0,n.C)(e.itemId,{authentication:e.authManager,portal:e.portal,params:{owner:e.username,start:o*r+1}})],[])),o=i.reduce((e,t)=>[...e,...t.resources],[]);return o}return i},fetchItemResource=e=>{let t=`${(0,l.Zl)(e.portalHost,e.authManager)}/content/items/${e.itemId}/resources/${e.resourceId}`;return(0,i.WY)(t,{authentication:e.authManager})},getItemGroupIds=async e=>{var t,r,i;let o=await (0,n.tX)(e.itemDetails.id,{authentication:e.authManager}),a=(null===(t=o.admin)||void 0===t?void 0:t.map(e=>e.id))||[],u=(null===(r=o.member)||void 0===r?void 0:r.map(e=>e.id))||[],s=(null===(i=o.other)||void 0===i?void 0:i.map(e=>e.id))||[],c=[...a,...u,...s];if(e.excludeFavoritesGroup){let t=await e.authManager.getUser(),r=t.favGroupId;return c.filter(e=>e!==r)}return c},isCopiedItem=e=>e.typeKeywords&&e.typeKeywords.includes("Copy Item"),isDocumentItem=e=>e===c.dq.Image||e===c.dq.PDF,maybeAddTokenToItemUrl=(e,t,r)=>isDocumentItem(e.type)&&e.access!==a.eJ.PUBLIC&&(null==r?void 0:r.token)?`${t}?token=${r.token}`:t,getItemThumbnailUrl=e=>{var t,r,n;let{portalHost:i,itemDetails:l,fallbackUrl:d,authManager:p,size:m,isGroup:g,returnOriginalAspectRatio:f,shouldIgnoreDPR:h}=e,I=l.modified&&36e5>Math.abs(new Date(l.modified).getTime()-Date.now())?`&d=${l.modified}`:"",v=(0,s.G)(l);if(l.id&&(l.thumbnail||(null==v?void 0:null===(t=v.thumbnail)||void 0===t?void 0:t[0]))){if(/^https:\/\//.test(l.thumbnail))return l.thumbnail;if(l.type===o.Cs){if((null==v?void 0:null===(r=v.thumbnail)||void 0===r?void 0:r[0])==="default")return d;if((m||f)&&(null==v?void 0:null===(n=v.thumbnail)||void 0===n?void 0:n[0])==="url")return(0,u.aU)(v.thumbnail[1],{width:m??400,authManager:p,shouldIgnoreDPR:h,portalHost:i,publicItemIdForCDN:l.access===a.eJ.PUBLIC&&l.id?l.id:void 0})}return`https://${i}/sharing/rest/${g?"community/groups":"content/items"}/${l.id}/info/${l.thumbnail}?w=800${(null==p?void 0:p.token)?`&token=${p.token}`:""}${I}`}return l.type===c.dq.Image?`https://${i}/sharing/rest/content/items/${l.id}/data${(null==p?void 0:p.token)?`?token=${p.token}`:""}`:d},getItemPage=(e,t,r)=>{let n=(0,l.$E)(t,r);return`${n}/home/item.html?id=${e}`},isAgolItemAWSUrl=e=>/ago-items?-/.test(e.host)&&e.host.endsWith(".amazonaws.com")&&e.searchParams.has("X-Amz-Security-Token")&&e.searchParams.has("X-Amz-Credential"),getAgolItemDataUrlFromAWSUrl=(e,t)=>{try{let r=new URL(e);if(!isAgolItemAWSUrl(r))return;let n=(0,l.Zl)(t),i=r.pathname.match(/^\/([A-Za-z0-9]{32})\//),o=i&&i[1];if(o)return`${n}/content/items/${o}/data`}catch{}},isItemOwnerOrAdmin=(e,t)=>"admin"===e.itemControl||e.owner===(null==t?void 0:t.username),isItemViewerDuplicable=e=>{var t;return void 0!==e.isViewerCopiable?e.isViewerCopiable:!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes(o.Mk))},isItemIndexable=(e,t)=>{var r;let n=t??e.access;return n===a.eJ.PUBLIC&&!(null===(r=e.typeKeywords)||void 0===r?void 0:r.includes(o.LB))}},841787:function(e,t,r){r.d(t,{Jt:function(){return getImageUrlTemplate},aU:function(){return evaluateImageUrlTemplate}});var n=r(409496),i=r(968843),o=r(500052),a=r(201437),u=r(606930);let s={width:"w",widthWithArcGISBreakPoints:"wago",authManagerToken:"ust",sharingUrl:"https://su.example"},getImageUrlTemplate=e=>{let addBrackets=e=>`{{${e}}}`;if("simple"===e.template)return"sharingUrl"===e.replacer?s.sharingUrl:addBrackets(s[e.replacer]);if("queryParam"===e.template){let t=e.replacers.reduce((e,t)=>"width"===t.replacer?e.concat([[s[t.replacer],t.queryParam]]):s[t.replacer]?e.concat([[s[t.replacer]]]):e,[]);return addBrackets(`qp|${JSON.stringify(t)}`)}return""},evaluateImageUrlTemplate=(e,t)=>{let r=!1,c=t.width?t.width*(t.shouldIgnoreDPR?1:(0,a.D7)()):void 0,l=e.replace(RegExp(`{{${s.width}}}`),String(c??window.innerWidth??2e3)).replace(RegExp(`^${s.sharingUrl}`),(0,o.Zl)(t.portalHost));t.publicItemIdForCDN&&RegExp(`^${(0,o.Zl)("www.arcgis.com")}/content/items/${t.publicItemIdForCDN}/resources/\\S`).test(l)&&(r=!0,l=l.replace(/^https:\/\/www/,"https://cdn"));let d=[];return l=l.replace(RegExp("{{qp\\|([^;]*)}}"),(e,t)=>{try{d=JSON.parse(t)}catch{}return""}),l=d.reduce((e,o)=>{var a;let l=o[0];if(l===s.width&&c){let t=o[1];return(0,u.Cn)(e,{[t]:String(c)})}if(l===s.widthWithArcGISBreakPoints&&c){let t=(0,i.n)({width:c,shouldIgnoreDPR:!0});return(0,u.Cn)(e,{w:String(t)})}return!r&&l===s.authManagerToken&&(null===(a=t.authManager)||void 0===a?void 0:a.token)&&(0,n.$)(e,t.portalHost)?(0,u.Cn)(e,{token:t.authManager.token}):e},l)}},969252:function(e,t,r){r.d(t,{G:function(){return getItemDetailsProperties},M:function(){return getItemDetailsPropertiesToSet}});var n=r(298537),i=r.n(n);let getItemDetailsProperties=e=>{try{let t="string"==typeof e.properties?JSON.parse(e.properties):e.properties;return t??void 0}catch{return}},getItemDetailsPropertiesToSet=(e,t)=>{if("replace"===t)return JSON.stringify(e);let r=getItemDetailsProperties(t)??{},n=i()({},r,e);return JSON.stringify(n)}}}]);